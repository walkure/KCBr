charset:utf-8 CRLF

KCBr2 (KanColle BRowser v2) 適当なトリセツ  by http://www.3pf.jp/ 2016 Apr.

■やってること
IWebBrowser2(要はInternet Explorer)に艦これFlashを表示させて、通信をHttpListenerで覗いて流れてるJSONを適当にデコード
して表示します。このソフト自体が艦これサーバに対して通信を発するわけではないので、ゲームFlashを操作しないと表示できない
情報が存在します。

■使い方
KCB2.exeを起動すると、画面が一個以上出ます。ゲームのログイン画面を表示するので、ID/パスワードを入れたらゲームが
始まります。Internet Explorerでの操作と何ら変わりません。

AnyCPUなので、x64環境ではx64のIE/FlashPlayerを要求します。x86でのみFlashPlayerが入っていても動きません。

HttpListenerを使って通信を傍受するので、Windows Vista以降のOSではnetshを使ってprefixのアクセス許可設定をしないと
正常に起動しません(設定は後述)。


■設定について
ステータスバー右端の操作→設定 で設定画面が開きます

・詳細な状況をステータスバーに表示する
APIの呼び出しを検出など内部で処理が起きる度にステータスバーに通知します。

・プロキシポート
通信を眺めるために、ブラウザとゲームサーバの間にHTTPプロキシを挟みます。この際、TCPポートをひとつ
占有します。HTTPプロキシはSystem.Net.HttpListenerとSystem.Net.HttpWebRequestを使って実装されています。

ブラウザ(艦これゲームFlash) <-> HttpListener <-> HttpWebRequest <-> ゲームサーバ(角川)

HttpListenerは指定したポート(デフォルトで8088を占有します)をhttp.sys経由で見に行くので、Windows Vista以降のOSでは
事前にポートへのアクセス許可設定が必要です。

C:\> netsh http add urlacl url=http://127.0.0.1:8088/ user=everyone

別にユーザ名はeveryoneである必要はなくて該当ユーザでも大丈夫でしょう。netshを叩くコマンドプロンプトは管理者で
起動しないとだめですね。

ポート番号を変えたい時は、portの数字を適当に変えて再起動してください。

システムのプロキシ設定をそれなりに拾うはずですが、明示的に別のプロクシ経由の設定をするときはその設定を
しておいてください。

・大破判定閾値
出撃/進撃リクエストが飛んだタイミングでHPの減り具合をチェックして、一定値以下だと警告を出します。そこでキャンセル
すると、リクエストを握りつぶしてサーバに送らず、エラーJSONをFlashへ返します。よって、猫画面が出ますがリロードすると
撤退できているはずです。

0%のときは大破抑止機能は働きません。轟沈要件にはHP以外にもConditionが関わるっぽいんですが、ようわからんので取り敢えず
26%をデフォルトにしてあります。実際の表示は25%が大破中破の閾値なようですが。

旗艦の大破進撃を抑止するために、進撃するかどうかを出す直前に艦隊情報を更新かけてるので実装できていますが、万が一挙動が
変わって艦娘のHPが取れなくなると抑止できなくなります。ソフトウェアで出来る限りのことはしていますが、くれぐれも誤進撃
には注意しましょう。

・疲労回復インターバル
艦隊の疲労が取れるまでの時間を表示しますが、どこまで疲労度が戻ったら回復とみなすかを指定します。
最大値は49です。0にすると時間表示やめます。

・ブラウザバージョン
IWebBrowserは何も設定しないとIE7として起動してきます。これだとIE9以降に実装されたGPU描画支援が働かないので
Flashも含めた描画がかなり遅くなります。IE9以降が入ってるマシンでは、設定してあげると動きが明らかに軽くなります。
XPはIE8までしかインストール出来ないのでGPU支援を使えず、結果的に遅くなります。

IE9が入ってるマシンでIE11を設定してもIE9として動くだけで問題はないようです。なお、この設定はレジストリを書き換えます。
詳細は、以下のエントリを参照してください。
http://msdn.microsoft.com/en-us/library/ee330730(v=vs.85).aspx#browser_emulation
http://msdn.microsoft.com/en-us/library/ee330731(v=vs.85).aspx#gpu_rendering
HKCU以下を弄っているのでUACに引っかかって殺されるようなことはないはず。なお、レジストリの該当変更はIE7を設定することで
消去されます。

最新のFlash Playerだと、IEのレンダリングモードによらず描画するっぽいので、設定を変える必要はあんまりないかも。

・ダイアログ抑止
WebBrowserが表示するスクリプトエラーダイアログ等のダイアログを抑止します。DMMのOpenSocialエラーダイアログもおそらく
抑止されるので、もしかすると不都合が生じるかもしれません。

・記録
記録をどこに保存するか。ディスク・Google Spreadsheetのどれか

>ローカルに保存する場合：ログの保存先を指定します。空白の場合、KCB2.exeが起動する際のカレントディレクトリになります。
>Google Spreadsheetに保存する場合：認証URIが出るので、ログを保存したいアカウントでログインしたブラウザでそのURIへ
アクセスし、返された認証キーを打ち込んでください。

・スクリーンショット
スクショを撮った時の保存先を指定します。

・詳細表示
メインウィンドウで艦娘名前をクリックすると表示される詳細ウィンドウに何を表示するか選択します。

・タイマ
出渠通知などのタイマ設定をします。デフォルトだと、KCB2.exeの起動/終了に同期してKCBTimer.exeを起動/終了します。

・設定ファイル保存パスについて
.NETの設定保存システムそのまま使ってるので、設定ファイルはかなり深いところへ保存されます。なので、保存先を表示して
います。設定を初期化する場合はここに書かれたファイルを消せばいいはず。原則、ウィンドウ位置やらリストビューの幅やら
並び順は全部覚えています。

・マスタデータを表示
マスタデータを次回起動時から表示できるようにします。

・離脱判定時に敵艦状態を表示
夜戦に入るかどうか選択する画面が出る際に、敵艦の現況を表示します。


■メインウィンドウ
上から、資材、艦隊、遠征、ドック/任務の4つの情報を表示しています。
資材情報は特に説明の必要はないですね。

艦隊情報は、コンボボックスで表示する艦隊を切り替えることが出来ます。コンボボックスの選択はマウスホイールで切り替えも
出来ます。

表示内容は、以下のとおり
「五十鈴|12 49 100 [][][]」-> 五十鈴Lv12 HP100% []は装備してる装備種別のアイコンが出ます。
補給状況は艦娘名前の背景色で表示しています。補給状況によらず、ドック入りしてる場合は水色背景です。
適当にツールチップで補足情報が出ます。なお、艦隊メンバーの各行をクリックするとサブウィンドウが出ます(後述)。
当初は「五十鈴12」のような表示にしてたんだけど、潜水艦が半角数字使うので「伊1689」になって悲しいのでセパレータ
入れました。なお、パーセントは小数点以下切り捨てています。ここの艦隊が疲労取れるまでの時間をステータスバーに
表示します。

整数表示のHPは、25%以下は切り捨てて25%より上は切り上げ表示しています。
ex. 25.1% -> 26% 25.0% -> 25% 24.9% -> 24%

遠征情報は、艦隊名、帰還までの時間、遠征名が出ます。帰還までの時間はクリックすることで終了予定時刻と
カウントダウンが切り替わります。艦隊名の背景がピンク系の色になっている場合、燃料または弾薬が補給されていません。

ドックは建造/修復される艦娘名と終了までの時間が出ます。これも、時間をクリックすることでカウントダウンと
終了予定時刻がトグルします。ここで任務を選ぶと、現在選択中の任務一覧が出ます。

■ステータスバー
・表示
艦娘一覧、装備一覧、ログを別ウィンドウで表示します(後述)

・キャプチャ
ゲーム画面のスクリーンキャプチャを保存/クリップボードへ放り込みます。キャプチャは押した瞬間に行われます。

・音量
音量調整バーを表示します。Vista以降の場合、ゲームプロセスだけの音量調整が出来るはずです。

・進行中任務
進行中任務を示すサブウィンドウが開きます(後述)

・操作
設定画面などが出ます。ゲーム画面の再読み込み、表示位置の調整、キャッシュのクリアも出来ます。
また、タイマの起動もここから行えます(後述)。

ゲーム画面の再読み込み→猫った時など
表示位置の調整　　　　→Flashに入力フォーカスが有る状態でTabキー押すとブラウザ内でフォーカスが
　　　　　　　　　　　　切り替わって表示位置がずれた際の対策
キャッシュのクリア　　→必要に応じて
画面をロック　　　　　→トイレにいくとかそんなときに。いたずら入力を避ける程度はできるでしょう。

ステータスバーではサブウィンドウで選んでる艦隊の制空値、索敵値、コンディション回復までの時間を表示します。
索敵値は所謂2-5用の値と単純合計値を表示しています。

制空値：http://wikiwiki.jp/kancolle/?%B9%D2%B6%F5%C0%EF
索敵値：http://wikiwiki.jp/kancolle/?%C6%EE%C0%BE%BD%F4%C5%E7%B3%A4%B0%E8#area5

■サブウィンドウ
艦娘の装備情報と進行中任務はサブウィンドウで表示します。

装備情報はウィンドウ左側の艦隊メンバーをクリックすると出ます。進行中任務はステータスバー左側の[進行中任務]を
クリックすると出ます。どちらも、ウィンドウを右クリックするとサイズを変更できるようにしてあるので、文字がはみ出て
スクロールバーが出ちゃうようなときは適当に修正してください。フォーカスを失うとウィンドウは消えます。

・装備情報
艦娘の装備やステータスが出ます。

・進行中任務
選択してる任務一覧が出ます。表示は艦これflashでクエスト一覧を表示するまで読み込まれないので、クエスト一覧を表示する
前に表示しようとするとエラーダイアログが出ます。


■表示できるウィンドウ

艦娘一覧、装備一覧、ログを別ウィンドウで表示できます。

・艦娘一覧
所有艦船とそのステート一覧が出ます。カラムのヘッダ押すとそこでソートします。ソート順はクリックする毎に正順逆順と
トグルします。また、カラムの幅を変えたり、ヘッダをドラッグすると並び順が変わったりします。ソートする値は基本的に
表示されている値ですが、一部の値はそれだとわかりにくいので、ソートする際に自分が必要だと思ったパラメタでソート
するようにしてあります(HPや燃料弾薬は最大値、回避索敵対潜運は現在値、火力など近代化改修パラメタは
現在値/最大値の割合でソートします)。

ウィンドウタイトルには、艦隊所属の艦娘数と総艦娘数が表示されます。

コンディションは値に応じて色がつきます。閾値と色は艦これ攻略Wikiを参照しています。
http://wikiwiki.jp/kancolle/?%C8%E8%CF%AB%C5%D9

キラキラ：水色
平常：背景色変化なし
間宮点灯：ベージュ
黄色：黄色っぽい何か
赤色：薄赤色

閾値経験値は艦これ攻略Wikiの表を元にしています。内部的には表引きではなく数列とみなして一般項を導出した式を組み込んで
あります。
http://wikiwiki.jp/kancolle/?%B7%D0%B8%B3%C3%CD

Lvが改造可能レベルに達していると、レベル欄の背景が緑になります。

艦船のパラメタをごりっと表示するので、ごちゃごちゃしてて見難ければ幅0にして非表示にしてください。
起動してゲームFlashを起動した直後、GAME STARTを押すまで艦船パラメタ一部取れません。

HPや燃料・弾薬の残存割合に応じて色を付けるようにしてみました。
割合が
20%以下：赤
30%以下：黄
40%以下：ベージュ
80%以下：淡黄
それ以外：緑
という感じで適当に決めた。ホントは大破中破小破に応じたかったんだけどようわからん。

HPとか対潜とかのパラメタは「11/39」のような形式で表示しています。これは「現状値/最大値」という形式で読んでください。

火力対空装甲雷撃は、改装上限になっている場合背景色をつけるようにしました。近代化改装直後は正しい値が取れなくて
色がついたりつかなったりとおかしくなるんですが、ホーム画面に戻れば正常になるはず。

・装備一覧
装備と、装備をつけてる艦娘、装備のパラメタが適当に出ます。
装備毎にまとめて表示するウィンドウと、装備を全部展開してパラメタ含め表示する二つの窓があります。お好みに応じて。

・記録
装備開発、艦船建造、戦闘結果、遠征結果、資源情報の記録を取ります
デフォルトではKCB2.exeを起動したディレクトリ以下にユーザIDでディレクトリを切って、CSVで保存してます。
ディレクトリが生成できない場合は例外が飛びまくるのではないかなぁ。

戦闘記録はダブルクリックすると、艦隊編成を別窓で表示します。
艦娘名に*がついてるのがMVP、xがついてたら撃沈です。

・資源
資源の推移が出ます

■タイマ
Vista以降はプロセスごとに音量を調整できるので、修復ドックと遠征のタイマを別プロセスにしました。
よって、ゲームそのものをミュートしていても出渠/遠征帰還アラームを鳴らせます。
タイマはKCBTimer.exeが実体で、これを適当に起動しておくか、ステータスバーのメニューから「タイマへ情報を送信」を
選ぶことで起動します。タイマを起動しておけば、自動的にKCB2から情報を随時送って更新していきます。

出渠および遠征終了時の通知音はこのタイマプロセスが鳴らします。

■開発者メニュー
設定の「開発者メニューを有効」をチェックして再起動すると開発者モードが有効になります。
これは、JSONログビューアと艦これセッション情報表示の2つから構成されています。
どちらもデバッグビルドでのみ有効にしていたものをそのまま使っているので、UIはあんまり親切ではありません。

・JSONログ表示
艦これAPIがやりとりしているJSONを表示します。特にpretty printはしていないので、見る際は適当なフォーマッタに貼り付け
とかしてください。ログ表示ウィンドウを閉じている時も、最近10個のJSONは内部で覚えている(10以上は古いのから順に忘れる)
ので、ログ表示ウィンドウを常に開く必要はありません。ウィンドウを開いている間は全てのJSONを覚えているので、艦これの
JSONは割と大きいのでメモリを消費します(JSONはdeflateして覚えてますが)。

・セッション情報
接続先サーバとセッションを取得した時刻、セッショントークンを表示します。


■マスタデータ表示
設定の「マスタデータ表示を使う」をチェックして再起動すると、表示メニューからマスタデータ表示ウィンドウを出せます。
艦船・装備・艦船装備の３情報が表示できます。深海棲船含めて全部表示するのでネタバレ全開になるんで見たくない人は
注意してください。

■使ってるライブラリ
JSONのパース：Json.NET ( http://james.newtonking.com/json )
Googleスプレッドシートへのアクセス .NET library for the Google Data API ( https://code.google.com/p/google-gdata/ )
各ライブラリのライセンス文章はAboutダイアログから確認できます。


■参考にしたURI
C# と .NET Framework で作る簡単プロキシサーバ
 http://d.hatena.ne.jp/wwwcfe/20081228/1230470881
Listbox Control with Tooltip for Each Item
 http://www.codeproject.com/Articles/457444/Listbox-Control-with-Tooltip-for-Each-Item
－AxWebBrowserのIInternetSecurityManager－
 http://www.divakk.co.jp/aoyagi/csharp_tips_wbzone.html
How to I display a sort arrow in the header of a list view column using C#?
 http://stackoverflow.com/questions/254129/how-to-i-display-a-sort-arrow-in-the-header-of-a-list-view-column-using-c
ミキサー　その１（音量の調節）
 http://hp.vector.co.jp/authors/VA016117/mixer1.html
ミキサー　その２（ミュート）
 http://hp.vector.co.jp/authors/VA016117/mixer2.html
ミキサー用の構造体とか関数を C# 用に定義し直す 
 http://www11.ocn.ne.jp/~ikalu/csharp/0005.html
C# で メッセージキュー - だれかの雑記
 http://d.hatena.ne.jp/zarchis/20101015
縦に長いwebページをキャプチャする
 http://passing.breeze.cc/mt/archives/2005/09/web.html
表示したWebページ全体をキャプチャしたい，の巻（ソース編）
 http://musi-chan.at.webry.info/200605/article_11.html
WEBページをビットマップ保存するサンプル(C#.NET)
 http://homepage2.nifty.com/nonnon/SoftSample/CS.NET/SampleWebBitmap.html
Displaying the build date
 http://stackoverflow.com/questions/1600962/displaying-the-build-date

■勝敗判定について参考にしたURI
 http://wikiwiki.jp/kancolle/?%BE%A1%CD%F8%BE%F2%B7%EF
 http://sorohai.blog49.fc2.com/blog-entry-602.html
 http://wakaranpos.blog33.fc2.com/blog-entry-487.html
 http://kannkore.com/system/victory-condition/
 http://kancolle.doorblog.jp/archives/33338525.html

■ファイアウォールの警告
(指定された)適当なtcpポートをlistenするので、初回起動時にWindowsファイアウォールの警告が出ます。
ウィルススキャナが反応するかどうかは試してないのでわからない。

■動作ログ
JSONの処理時に失敗して例外が飛んだ場合、時間.logというファイルを作ってスタックトレースやエラー情報を
保存します。なんかあったら、そのファイルを送ってください。
同時に「時間.log.session」という形式でそのJSONをやりとりしたセッションを保存します。必要に応じて
そのファイルもデバッグに使います。

■実装
C# / .NET Framework SDK 4.0 / MSVS2010 Pro.

■テスト環境
・WindowsServer2008R2(x64) + IE11
・WindowsXPSP3(x86) + IE8
・Windows7 Home Premium(x64) + IE10 

ブイン基地 ショートランド泊地 トラック泊地 単冠湾泊地 鹿屋基地 岩川基地

■オンラインログ機能について
Googleスプレッドシートに書き込むことで、複数箇所でのプレイ時にもログを共有できるようにしました。
研究室マシンと下宿マシンとかそんな感じで、共用マシンで設定抜かれると該当のGoogleドライブに対して
ほぼフルアクセス権限が取れてしまいますので要注意。

■既知の問題点
・96dpi以外の環境だと悲しいことになるはず
96dpiの環境しか持ってないので修正する気力がない。

・アイコンがしょぼい
誰か描いてよ。

・ブラウザ内のフォーカス位置によってフラッシュ表示の再設定がうまくいかない
原因不明。

■時々聞かれること

・なんかIEのエラーダイアログがようけ出る。
IEエミュレーションバージョンがIE7以下になってると出るようです。IE8とかIE10など当該マシンでの最新IEを設定すると
出なくなるはず。それでもダメなら、設定画面の「ダイアログ抑止」をチェックしてみてください。ただ、これを使うと
DMM OpenSocialのセッション更新失敗ダイアログも抑止されるので何が起きるかわかりません。

・重くね？
.NETだからある程度は仕方ないんですが、いくつか。

1.NGEN(ネイティブイメージ生成)を使う。
.NETの実行ファイルは起動時にマシンネイティブイメージにJITコンパイルされて動くんですが、コンパイル時間がどうしても
かかるので起動する際に時間をくったりします。で、事前にコンパイルするツールが有ります。

http://msdn.microsoft.com/ja-jp/library/6t9t5wcf(v=vs.110).aspx Ngen.exe (ネイティブ イメージ ジェネレーター)

ngen.exeの場所は一意ではなさげなので適当にマシン内で探してください。

.NETの実行ファイルが起動する過程はMSDNに書いてあります。

http://msdn.microsoft.com/ja-jp/library/k5532s8a(v=vs.110).aspx マネージ実行プロセス

2.GC(ガベージコレクタ)を変える。
KCB2.exe.configファイルを書き換えることでGCを変更できます。デフォルトではワークステーションGCですが、マルチコアCPU
の場合はサーバGCが最速らしい。GCが頻繁に走るのだめちゃうん、という話はさておき。

http://msdn.microsoft.com/ja-jp/library/ms229357.aspx
<gcServer> 要素
http://msdn.microsoft.com/ja-jp/library/yhwwzef8(v=vs.110).aspx
<gcConcurrent> 要素

KCB2.exe.configの</configSections>と<userSettings>の間にこんなことを書くとサーバGCになります。
   <runtime>
      <gcServer enabled="true"/>
      <gcConcurrent enabled="true"/>
   </runtime>


どんな設定をすると最速はマシンによるんで一概に言えません。適当に設定してみてください。

ちなみに、マルチスレッド(2-3ぐらい動きます)で動いてるので<Thread_UseAllCpuGroups>あたりも設定したら速くなるかも
しれない(未検証)。

・ウィンドウがデスクトップの表示範囲外に飛んでいってしまって連れ戻せない
システムメニューから「ウィンドウ復帰」を呼ぶことで連れ戻せるようにしました。

■注意
言うまでもないんですが、このソフトウェアの使用は全て自己責任のもとに行ってください。開発者は一切の責任を取りません。
公式がTwitterで「厳密には規約違反」と仰っているのでアカウントBANされる可能性もゼロではありません。

要望・質問には気が向いたら答えますが期待しないでください。

一次配布サイト( http://www.3pf.jp/products/kcb )以外からの再配布は一切禁止します。

■連絡先
http://www.3pf.jp/profile を参照

■revision history
2013/12/01 2.0.0.0
 first release
 
2013/12/11 2.0.0.1
 戦闘結果詳細ウィンドウの表示位置保存ができてなかった
 遠征終了通知を終了1分前ににした
 プロキシポートの自動設定ができるようにした
 12/11メンテで一部APIの返すデータ形式が変わったので追随した

2014/01/12 2.1.0.0
 ・スクリーンショットをディスク上へ保存できるようにした。
 ・AnyCPUでビルドするようにしました。x64環境ではWOW64(32bitエミュレーションレイヤ)ではなくx64で走るので、
   x64版IEにFlashをインストールしてください。
 ・ブラウザバージョンに関係なくブラウザのGPU支援を使えるようにしてみた。次revでブラウザバージョンの設定消えるかも
 ・第2-4艦隊の補給状況を遠征一覧にて分かるようにした。
 ・艦娘一覧で改修上限に達していたら背景色を変えて分かるようにした。また、ソート順を改修達成度にした。
 ・艦娘一覧で艦娘名のよみがなと、艦娘種類ID(1-150までは艦娘カードIDと同じ)を表示するようにした。

2014/02/02 2.2.0.0
 ・大破進撃確認ダイアログにダメコン有無を表示するようにした
 ・通知タイマの起動/終了を専ブラの起動/終了に同期するようにした
 ・通知タイマプロセスの設定ダイアログを設定ダイアログから呼べるようにした
 ・艦船建造時に開発資材数を記録するようにした
 ・24時間以上の遠征残り時間で日数+24時間以内の時刻だったのをやめて、48時間だろうが72時間だろうが時分秒で表示するように
 ・装備種別が増えたので追加
 ・記録の表示を仮想リストビューにしました。大量のログがある場合、表示が速くなるはず
 ・FiddlerCoreのversionを4.4.5.6にupdate
 ・記録の保存ディレクトリを指定できるようにしました。
 ・記録の保存ディレクトリ以下にユーザIDでサブディレクトリを切って、保存するようにしました。
 ・記録情報を明示的にCSV形式でエクスポートできるようにした
 ・遠征保存先をexpedition.csvからmission.csvにした
 ・JSONパーサをJson.NETに変更した。少しは速くなるはず。
 ・Fiddlerの使うプロキシ設定を上書きできるようにした

2014/03/05 2.3.0.0
 ・Json.NETを6.0.1にupdate
 ・FiddlerCoreを4.4.6.3にupdate
 ・記録をGoogle Spreadsheetに保存できるようにした
 ・ステータスバーに表示するメッセージが増えた
 ・Flashへ処理を返すのをできるだけ早くした
 ・艦隊情報の補給状態を燃料だけではなく弾薬も含めた状態を表示するようにした
 ・スクリーンショット取得時、提督名などの表示部をキャプチャ範囲から外せるようにした
 ・2/26メンテで追加された装備種別を追加
 ・ウィンドウ最小化時して終了するとウィンドウ状態復帰に失敗していたbugを潰した
 ・UIの簡易ロック機能を付けた
 ・Lv150以降の所要経験値を算出できるようにした
 ・疲労が取れるまでの時間を表示するようにした

2014/03/16 2.4.0.0
 ・24h以上の修復時間を表示できないbugを潰した
 ・艦娘名クリックで表示される詳細ウィンドウの表示内容を選べるようにした
 ・ステータスバーに艦隊速度区分とレベル合計を表示するようにした
 
2014/04/29 2.5.0.0
 ・制空値を表示するようにした
 ・装備種別アイコンを艦娘一覧などあちこちで表示するようにした
 ・装備ごとにまとめて表示する窓を作った
 ・マスタデータを閲覧できるようにした
 ・装備破棄する際の確認ウィンドウをつけた。
 ・任務をメイン画面でリアルタイムに確認できるようにした
 ・4/23メンテでの大規模データ構造変更に対応したはず
 ・近代化改装時にパラメタがおかしくなるバグを潰したはず

2014/04/30 2.5.1.0
 ・艦艇修理施設のアイコンを入れ忘れてた・・・。
 
2014/04/30 2.5.2.0
 ・艦隊全外しの対応を忘れていた
 ・艦娘詳細表示の項目が1つも選ばれていない場合に落ちるbugを潰した
 
2014/04/30 2.5.3.0
 ・旗艦を変えると艦隊全外しになってた
 ・高速修復剤の使用を即座に反映するようにしました
 ・スレッド間を行き来するデータのロックを増やしました。
 
2014/05/01 2.5.4.0
 ・装備を短時間に変更し続けるとリソース使い尽して落ちるbugを潰したはず
 ・近代化改装の素材に艦隊メンバーを使っても母港に戻るまで表示が残ったままだったのを直した

2014/05/06 2.5.5.0
 ・大破進撃警告ウィンドウで背景色を付けるカラムを間違えてた
 ・GC設定をバージョンダイアログで表示するようにした

2014/05/26 2.5.6.0
 ・Json.NET v6.0.3に更新
 ・FiddlerCore v4.4.8.2に更新
 ・ウィンドウタイトル艦娘数の更新が遅れることがあるbugを潰した
 ・編成組換時に落ちることがあるbugを潰した
 ・改造直後に装備情報が表示されないbugを潰した
 
2014/06/25 2.5.7.0
 ・メイン画面での艦娘詳細表示で装備によるパラメタ減少分を表示できないbugを潰した
 ・6/20メンテで追加された新装備(照明弾)に対応
 ・FiddlerCore 4.4.8.4にupdate

2014/06/25 2.5.8.0
 ・6/6メンテで追加された新装備種別(潜水艦魚雷)を入れ忘れてた

2014/08/18 2.6.0.0
 ・艦娘一覧で修理時の所要鋼材/燃料を表示できるようにした
 ・開発者メニューを実装
 ・潜水艦が建造された際に例外が飛んでいたbugをfix
 ・未知のAPIを検出するとログを取るようにしました
 ・戦闘情報を解析して戦闘終了時に損傷情報をUIへ反映するようにしたつもり。
 ・8/8メンテで追加された装備種類を追加
 ・未知の装備情報を受け取っても落ちないようにしたつもり
 ・装備スロットが5以上の場合も落ちないようにしたつもり。
 ・Json.NET 6.0.4に更新
 ・艦隊の索敵値を表示するようにした

2014/10/04 2.6.1.0
 ・9/26メンテで資材情報のJSONが変わって例外が飛ぶようになってたので直しました
 ・コンディション回復(推測)時に通知を出せるようにしました
 ・API既知リスト追加
 ・HP 25%近傍での計算方法を変更
 ・HPの表示時、一部は小数点第二位まで表示するようにしました。
 ・ウィンドウ最小化時、自動的にミュートできるようにした
 ・詳細ステータス表示時に戦闘終了後の艦娘ドロップ表示を隠せるようにした
 ・Json.NET 6.0.5に更新

2014/10/11 2.6.2.0
 ・10/10メンテでマスタデータのデータ削減が行われたので対応。艦娘一覧等リストカスタマイズが初期化されています。
 ・装備ロック機能が実装されたので対応し、ついでに艦娘ロックも即時反映するようにしました

2014/10/29 2.6.3.0
 ・装備改修あたりの新機能に対応。改修資材の表示が増えました。
   装備改修時に装備を消費するとリストから消えるはずですが、改修資材が足らなくてテストが十分ではありません。
 ・装備レベルの表示を装備一覧に追加しました。
 ・Json.NET v6.0.6に更新
 ・記録機能で独自のHTTPプロトコルによるデータアップロード機能を外しました。
 ・(RDPで使う際)音量調整/ミュート時にMCIデバイスが開けず例外が飛んで落ちることがあったので修正したはず。
 ・サブウィンドウ群の位置強制設定機能を実装しました。

2014/10/31 2.6.4.0
 ・ステータスバーで装備改修が必ず失敗と報告されるバグを修正
 ・装備一覧で射程を文字表記するようにしました
 ・装備一覧のカラムを並べ替えられるようにしました

2014/12/10 2.7.0.0
 ・装備ロック機能が実装されたので、装備廃棄時に確認画面を出せる機能を外しました。
 ・離脱判定(夜戦に入るかどうかの選択時)に敵艦の現況を表示できるようにしました。
 ・名前をKCBからKCBrに変えました。
 ・11/14メンテ(冬イベント開始)で実装された高角装置アイコンを追加
 ・スクリプトエラーダイアログ等を表示させないようにできるようにしました。
 ・艦隊選択コンボボックスにフォーカスがなくてもマウスホイール回転で艦隊を選べるようにしました。
 
2014/12/10 2.7.1.0
 ・高射装置のアイコン以外の装備情報を追加し忘れていたので追加

2015/04/05 2.7.2.0
 ・戦闘結果を予測するコードを入れて見た。時々ミスります。
 ・Json.NET 6.0.8に更新
 ・FiddlerCore 4.4.9.8へ更新
 ・離脱判定時の敵艦状況表示後に猫ると表示が消えないバグを潰した
 ・スクショ保存失敗時に落ちるバグを潰した
 ・冬イベ開始時、2/17と3/18のオンメンテで追加された装備種別を追加した

2015/05/01 2.7.3.0
 ・HTML構造が変わってFlash表示位置調整に失敗するようになったので修正した

2015/05/24 2.7.4.0
 ・イベント海域で発生する出撃海域ラベル番号を艦娘一覧に表示するようにした
 ・装備種別に大型飛行艇を追加
 ・5/18メンテで出撃中の艦娘状態取得APIが変わったので当座の対応をした

2015/05/26 2.7.4.1
 ・進撃中の艦隊に所属する艦娘の装備情報が消えるbugを潰した
 
2015/07/07 2.7.5.0
 ・Json.NET 7.0.1に更新
 ・ライセンス上の問題が生じたFiddlerCoreの使用をやめました
 ・Google Document List APIが4/20に終了していたのでDrive APIでスプレッドシートを生成するようにしました
 ・2.7.4で出撃時の艦娘状態を取得したもののUIへの反映を忘れていたので追加
 ・高速建造した際にUIの建造完了時刻が追随するようにした

2015/07/18 2.7.5.1
 ・7/17メンテでマスタデータの深海棲艦情報が消えたので、例外が飛ばないように処理するコードを入れた

2015/09/06 2.7.6
 ・8/10メンテで追加された装備の種類を追加
 ・連合艦隊での進撃時に第二艦隊の大破警告も出るようにした
 ・艦載機レベルをアイテムレベル欄に表示するようにした

2016/03/28 2.7.7
 ・装備レベルを装備スロットに表示するようにした
 ・遠征中断時に帰還タイマを更新するようにしました
 ・表示位置調整タイミングを変えてリロード時自動的に位置判定が走るようにしました
 ・通知タイマが他のマシンで走っていても通知できるようにしました
 ・通知タイマで昼戦・夜戦終了時の通知が出るようにしました。
 ・演習時も夜戦判定前の戦闘解析を表示するようにしました
 ・プリセット編成の読み込みを反映するようにしました
 ・3/19メンテで増えた装備のアイコン(特型内火艇)を追加
 ・任務情報キャッシュをクリアできるようにしました
 ・12/8メンテで上限Lvが155まで増えたのに対応

2016/04/01 2.7.7.1
 ・装備スロットに空きがある艦娘の詳細を表示すると落ちるバグを潰した
 
2016/04/02 2.7.7.2
 ・4/1メンテでマスタ情報などの様式が一部変わって起動しなくなるので対処した

2016/04/06 2.7.7.3
 ・装備保有状況によっては解析に失敗するバグを潰した
